function [Y,Xf,Af] = NNC202020full(X,~,~)
%NNC202020FULL neural network simulation function.
%
% Auto-generated by MATLAB, 24-Feb-2020 00:45:36.
% 
% [Y] = NNC202020full(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-3.452089;-3.577856;-3.605311;-1.181081;-1.194712;-1.161459;-0.9998944;-0.999858;-0.9996955];
x1_step1.gain = [0.290560924960026;0.286311695517819;0.285295838232695;0.85309419396888;0.850694230293987;0.840531787651411;1.00091358387368;1.00062243718705;1.0007487602224];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.63114021848407775295;-0.25506768025678444589;0.82010012753149819087;-0.30487376933999366102;-0.75867241643451133193;0.51387064163048190579;-0.64092045101473993363;-0.30747426113473208531;0.31936902683529039271;0.23630473675228505503;-0.89847142842422134112;0.35722487076659997784;0.41019473898699343462;0.62942119067430291057;-0.55239534902750730971;0.56510329078597965058;0.76576989632019831777;-0.67747143854452362977;-0.086455027728339031712;0.57845717077598279854];
IW1_1 = [0.14793818897753685526 -0.059861139158226987778 0.018965687925883094322 -0.11228821463104669831 0.20992335649198753944 0.07851231659455898404 -0.042106273938771511534 0.10985726823234935601 0.035445430637154197451;0.15126454556123519746 -0.86498325462395342367 -0.029388707423581399147 0.013672412567773040495 -0.40989738205904557855 0.069371081861489894416 0.064275203180886336662 -0.060832952333576072179 -0.0057212963997830667412;0.96582240022171017557 0.36865952353505943018 0.78047307327509163333 -1.0726685915121869641 -0.24401239888999792793 -0.20888946584959716679 1.0225274290919175169 0.036484057639123629313 0.2047959078477577799;-0.042630096453324280159 -0.12595632029475051228 -0.080270190667849128374 -0.20018083885222148766 -0.0080306083292513898847 -0.11904142274320400618 -0.077800013036162810054 0.028843643793504982614 -0.032031370865232777767;-3.5318557121334221982 5.5864275706779347175 -1.5729806703021333991 0.66496814272009763247 0.21475048619664643956 1.8559937853941443908 -0.51926576227659182461 -0.40020363543045833765 -1.7170869060088438385;-1.8708743481603997694 -0.60530324988781147866 -0.8394268320527753513 -0.14024297854460784918 -0.063745134704105185786 -0.10159532538965881932 -0.16686271090912546677 -0.1418193150199557051 0.07077831453790145444;-0.047153244500243225723 -0.15708251057363567527 0.53493995475563671516 -0.061509911542856753053 -0.18899102609145740361 0.50105117595116799301 -0.025836480805545371936 -0.093767667674604648909 0.21423869240789991664;11.915495707469753839 -1.56538012031672924 -4.761681652708192658 -6.2656390866804141382 -0.48930775780112417683 2.5698674453792822447 5.3468921339799084791 0.50123972039741149231 -2.1936486691021372941;2.2396732025429213486 3.194216799011546204 1.8805080026965892426 -0.082303980642730936723 -4.3678696159766481344 2.0916437243473309238 0.033794052867209073421 3.7102872386035037344 -1.6491811616522824568;-0.023689622667577330678 5.4085246761006660066 5.1247861231488380795 -1.2656089546101449983 0.65631515846605315012 -3.0679175400789162609 1.0993413041233000005 -0.53615319486102008817 2.5605977506042996161;-1.4665742804426904478 -0.17994775495689888101 2.1983931170142652078 0.3644737000699087015 0.019304288354002625133 -0.60941329607138350344 -0.22155850613677599559 -0.033740382081713933549 0.51361154252293528266;1.094625425305592703 -1.1384029341454078299 -0.68284965854877555103 0.18211075293967826649 -0.015477906572436576915 -0.10413353488775616007 -0.019375773915450669044 -0.030984614807586522561 -0.089093212459922202506;-0.081964290668073966351 -0.64499278669537418729 2.2695586419488966712 0.088929720915467760922 -0.022719225306663516639 0.1644959768788727128 -0.085448539547680613104 -0.0064872222218809987709 0.30150544621671981904;-2.6154373541149045224 -2.3473016993226654137 -4.23568843841115239 0.53404308332818306582 2.1747210513795387499 2.1073512833171363923 -0.48963481215860737983 -1.7400238029518158012 -1.599004284238171536;0.17012946778968379702 0.07754724162575835078 0.001914032541326077903 0.15544009827680430047 0.20405409501514532034 0.014223422115178482525 0.067102340307903990402 0.11162054848354570347 -0.012222157026333189955;1.3692163573224698236 3.1958012552472454537 -3.9281183306305935687 -0.010693148304814320895 -2.6056379245733323202 -1.0658601439029777858 -0.021690195533887839108 2.4417786376475554277 1.0751452566620740559;3.1953665113106555218 -0.063607764844392150616 2.3292916672700556546 -0.43167314144792201525 0.51417425216439316404 -0.42493469085924784334 0.1394761311111041846 -0.59493646278052947363 0.35797617856033164818;1.107642646916634499 3.0227410121807114507 -5.0345081857124878155 -0.21436081300983556019 -0.24081102808144572158 0.18336520483206400489 0.16237469530093490144 -0.066098932136035237761 0.30794242068956950709;-0.69558234653265238467 0.18061684062059951694 -0.64478969152337028969 -0.065773431813158866888 0.042479969915173533546 -0.084205068283382145111 0.01038009408071046899 -0.0084774828193120935899 -0.24297608369468642886;0.27238320390754905409 2.7260522512033387166 0.28329351101922906064 0.25830608870291849044 -0.7112666687604825011 -0.028955317896866221428 -0.20861847062572308475 0.36995244383451275638 -0.011748857696681739779];

% Layer 2
b2 = [-0.30467525805977113684;1.7531124691362425239;-0.084876417938042014733;-1.7679368018929322304;0.96396595696444709045;-1.4939649186940047176;0.23413794801276449631;-0.91535685677892653089;-0.69101595941535121082;-1.8336790883483806702;-0.22834629192150113219;3.0906186769038370699;-3.1370951378448630464;0.68182284152104999375;0.48230533631513172743;0.76657052310552276086;-1.1587515439721147725;-1.1945742284796174726;11.22697236660433795;0.073881088813404355298];
LW2_1 = [1.3759105898929582246 -0.40313500398112656065 0.0068654894842136836991 0.74544018015378088471 0.011769257637501223668 -0.025965448017476223941 0.20777507090035862714 -0.0063401436635134224978 0.0064894375774210595609 0.0012837736188107456894 0.054430271621468226395 -0.47036506119616755539 0.018898833679546825359 -0.016288847176693724284 0.31311872421509745479 0.0029051528317232547596 -0.066315066497996122408 0.051845832982887800344 0.30289602561900291766 -0.0029500682809266379897;0.53370461017792847347 -0.02397201782447332466 -0.053689974908558923961 -0.72447627734432351598 -0.017630551306144867652 -0.55979102161846072683 1.4621894033450661965 -0.016581279642469096136 -0.023312592864912089902 -0.0066059665298254183555 0.1691643909212707797 -0.70345009186076545848 -0.0075119816184983341859 0.024199991564695676194 -0.33803620064463435479 0.020668404250692478524 -0.043439068063802571684 -0.27889629474482507954 -0.38759946663876576611 -0.14554876512536113475;0.97960021341270142603 0.11748511745680416396 0.088696151660542107975 -1.6416391151487401689 -0.090090467943066132595 0.5304181181413043511 0.25990177418803123155 0.025819715442886834872 0.0074557091282069455282 0.076553781603908299669 -0.09179923366845682553 -0.11580615590428741668 0.23660206383906903782 -0.069089892754906165329 0.89952547516965319918 0.092163255391119594528 -0.22973121626057560474 -0.034884038192659290456 0.45866867452320192466 -0.17927917468240139875;1.1219792627765476922 0.44625170113745366018 -0.12591266975267684236 -0.38194029914344762577 -0.027009372434542253116 0.2985322000160247069 0.28749754473996619319 0.070977467459628504343 0.044421795195305702197 -0.068883430197173495246 0.15845079195165967523 0.10430116662683391882 0.77187930618127986726 -0.05507332273319865551 -1.8476769433003674692 0.033995761646139516232 -0.16679085641141605523 -0.18913653140281869169 1.0603585497681138339 -0.32580886670794811932;-1.0128009221753346836 0.0028201567675388487626 0.034994808282187594983 -0.03037959642819560574 -0.054445419390649514579 0.95882366546917063843 0.64342651460133015728 0.024812422191419925693 0.030913914993586207036 -0.0065134172516774163988 -0.011498180682851417977 0.59914977467331365091 0.17341792269449926578 -0.032499934142374571622 1.6788999309882757238 0.06378206756215268336 0.023123920456698157655 -0.092200627515941088741 0.19711220692174133418 -0.089186797412693613607;0.1005756764310129503 0.81143724747974177447 0.39961749339060470554 -0.50586124349155292546 -0.1938182760189580689 0.32802365041185482797 -0.28998877632118047476 0.0052238015282218960497 0.021853631763999830512 0.021143390161321034409 -0.79084531537865043749 0.32207113288296557174 0.0093529505069338582379 0.043692063714474475844 1.6452779446839269628 0.097719383353455632757 0.4249187819991548376 -0.13041166692733277555 -0.55048677465899953365 0.29277254456350887413;0.5308057327316921814 -2.3810547108474953149 -0.98345611965937107524 -0.0094647001647998607599 6.3833890352440265659 -0.19071473212797196428 -2.7068391153609123734 0.24420738818816659088 5.1796443462892822751 3.8035630519422327644 2.0293749502291462683 -1.368388319373916806 1.1427645280184755006 -5.3953950777352268631 -0.53003990963592606533 6.4712731261563796181 -1.1494687507926750758 3.1876057905960233363 0.61384381768233431398 5.0653532802332179585;1.3663620555804700807 0.00031335770359684723615 0.053550734442883038411 -1.4378577954625411106 0.046022760231030544753 -0.24690633572698234 -1.0940105714239056756 -0.026915079182035839267 -0.018943365118626185467 0.028753996393017559885 -0.011072130675034957958 -0.76210853945490020234 -1.2989788002503992459 0.023392221160498646859 0.4417984187676690655 -0.034639246092426703716 0.024729831847716102905 0.1636194919772854528 -1.753341267917641888 0.2342835117715519333;0.23301217202084370528 0.92199240510994118214 0.13032367272699746374 -1.0510491809740010183 0.045828324804656060676 -0.35680232176324355731 -0.52188117840742975773 0.020986240736825704373 -0.011427050138844201121 -0.010411098929470686755 -0.029527465077231911106 0.15752631682906409472 0.20574587967553012446 0.048819827495843313991 0.14511411343468430535 -0.047404555040237460195 0.13011939819084819558 -0.1593060049751587326 0.0072079275201364680081 -0.035962407664211930303;-1.7034349023341890383 1.1526255212594023192 -0.76026771638523416019 0.45875597842159704376 -1.2585801314619655678 1.4180495376471382585 1.9927613927243497116 -12.023468789263842993 1.3717337199871395548 -1.0541511799035496733 2.1915214236592541752 -0.63058659085284851642 -1.0096771844707737031 1.4964281349500394569 2.4233299022890162355 1.1893322799248051691 -1.0469326341785500922 -2.2300306269656053892 2.7254465680364288183 -2.7105631950915940465;-1.5661000301698102533 -0.16701862480711368586 -0.017202812087353705484 0.1957378058980939195 -0.021601246933479530815 0.43798498436316429805 0.811668491734281905 0.0032627983779853230763 -0.021500795659138035448 0.022944859498472656989 -0.026495876465931055693 0.71311622625318515922 0.061128690510994732055 0.044989908840710600424 -1.0819921223561805856 0.015136009164178017283 0.136867560904860186 -0.23517961551540050857 0.016777134229045413683 -0.20135798834800805457;1.4519388594540896253 -0.86864191646916877332 -0.32293390754184919667 -1.8834397329052052772 6.8003995623316129127 0.55306266052703056957 -1.4547456209763738322 0.63412124403982750298 -0.33375323464849260269 -6.961140500606068926 -2.5960984207544846036 0.59943752727512644718 -0.15667712215302978529 2.608971374130505172 -0.52119662130154797985 2.2845744119970623487 -1.0385799809846112396 2.0834741466220956241 0.51338298599091147789 0.55541406266209980558;-3.8376941031118039227 -2.2918342050867348547 1.0099826921705683525 0.31297801446517220514 -0.24552552296619806205 3.6237377670612826996 1.3229856554653731671 -0.037565545459401473993 0.057010147381297580915 0.075045258840745532325 -2.2124750179049206267 2.0922666502914823994 1.7673011484905347679 0.17519627623369166125 5.2893185013942387585 0.081380041038050451863 0.88824935627119860904 -0.58892063916779813226 0.50055205002436142792 2.0270935700702379378;-1.7803162757585859755 -1.3609840893575375631 0.3593227913635716475 0.48607047739992936819 0.16203567194207429969 0.38516766424257575796 0.6452720498108960312 0.058869928047618924616 -0.03187316198335639339 -0.016334043281978651713 -0.028092490467472076149 -0.3405651168871556278 0.68064219553035043564 0.027516773694638181624 0.17310122026082272462 -0.12379862924831724902 -0.047169097164425737023 -0.06539694290319569836 0.88574913128660914818 0.2085504288420840513;-0.30551936889541903009 0.34485150657006463648 -0.016322129675014111772 -0.087869548636468522429 0.059195017673681175896 -0.57153671645755665942 -0.3711322977841237658 -0.062133307488579543609 0.077722506685637557378 -0.046697663628744320863 0.13711590501924098007 -0.7901092923996715367 -0.17338331856250571716 0.027964319340644541723 -0.17474803766316213127 0.00050455998813030578792 -0.0037314414434548096033 -0.11697724465001202443 -0.29590461385672994776 0.23010395493243729348;1.0429338000189760649 1.121091925486501939 -0.13164779282775604385 -0.99163729727044258588 -0.055576632845038831388 -0.65890277375336714361 0.62719984863800681829 0.013388454336574642442 -0.049784045324277180489 0.042574681745372600083 0.42903219635339301385 -0.42171579130252156986 0.015033725593524824293 -0.10924966071582283 0.40248862070094076904 0.061628145134244444181 -0.31321566723544619348 0.43340490778281737239 0.45947244882993643067 -0.3348659570873864233;-0.16361604940975929545 0.013546969738969332625 0.28130576056599881918 0.47430711826327065506 -0.096781139066809213078 0.61131032056161693777 -0.0023826840819544496675 0.02523788100299678705 0.10228230490546524889 -0.018759070075464366611 -0.74572963454350338353 0.62069164166276169503 0.043733232425641463403 0.03673476822747009235 0.91374246187843044531 0.096868095996423944638 0.35480105327256095116 -0.1090030873868765432 -0.46115092433486132295 0.27065106406244715531;-0.17303909502861575254 0.017079909166631407347 0.0098682180561694733678 0.094392737849518446036 0.0090686964428021328566 -0.047935356682388532978 -0.94668198565800643074 0.0039055483352473008458 -0.0024800213805981912059 0.0032697589307858982224 -0.010507410036006165077 0.010258318096769004912 0.036384850603653623446 -0.00054510737421268218739 0.11040695195022903752 -0.0041512360499490535623 -0.0203142825257913405 -0.022924469686046743122 0.044794642009405812033 -0.043172517962130216307;4.7248789449870871593 -2.1606631966745895035 -2.9449782363439860333 -1.0032347897213536037 3.2144551102551583988 0.19675835167602023779 -2.1114467190684327313 0.87440780410503604614 -1.4159841085801077032 -2.5866333774878738083 1.9623389550421306282 1.7770300606320779124 2.3162646490102716257 -6.476712970977298589 -3.9992734343294795707 -2.6151091771179739709 -3.6996836050703016952 4.3299937868680018482 -1.6324315316060518111 -3.6845803107020107525;-0.48503731325593052448 0.14358503626022173227 0.038220425619419406971 0.82007553640622765645 -0.039111721692429129993 0.45512131092538271604 0.39510177474161795041 0.0043610269747856346412 -0.0030340443939862789952 0.026610423855670303078 -0.050002203333249554962 0.17961549280919936189 0.16951341618333493066 -0.0029721197517092205406 -0.8021509042090670949 0.027909704347479045994 -0.031569615315627221064 -0.026663079488888342256 0.35630533178589662846 -0.084079500363299128352];

% Layer 3
b3 = [2.1140669750841625252;0.23728065793385427762;0.8295085408123206161;1.4013078677909995839;2.7376134346243574669;0.91951388021893221136;0.3510234293009112938;2.1541314767954191645;0.74252432783059263421;2.5445479436433409148;1.7697538841232651752;-2.6221583566599173665;-0.36895501892261389765;-1.7280930866742958418;-2.3648837838068281769;2.631976059028539261;1.7998570456608227186;0.30537492487848977296;2.4557753571609439724;0.75052156558374472084];
LW3_2 = [1.792592152698097463 -2.3893123624879151201 0.34992568622032438341 2.0037542112756341339 -0.51786243264176090584 1.1824145477939438376 -0.014542198073744417794 1.5416122783952499464 0.89986637064370200711 0.0010428540957531848548 1.9375206346759716869 0.019097663379025842795 -0.99489769516207182676 -0.42690018751093483651 0.7601579926994062042 0.16512393963784330331 -1.2997670877397604627 -0.97221311139861354977 1.1132556538558613379 -0.2492734328927507792;0.92692286841806659226 -1.4956628294823033354 0.91430491205446751124 1.5737644737998619515 -1.2277026743481980198 -0.051682182500454608431 -0.00037282541168896061404 1.1866418338451647507 0.19465021298221510393 0.14413609919447004093 2.0097658080464295693 -0.0078822263503892566611 -1.5874776549120066527 -0.87753649381889220482 0.69344793548683203444 -0.0060482706841184404045 -0.64244964693615336238 -0.33181117758415773489 1.4066648041828431204 -1.0068339046504775069;0.0062092408327789590586 0.15748390222358776835 -0.68727481994996608705 -0.47048424910853570147 0.23955905524284390462 -0.21501797246016371434 -0.024160838984312989208 -0.41672140465431078971 0.093376528188097357441 0.0052338559279760448958 -0.34981498785454573364 0.03328630400505835224 0.26582965118069534771 -0.0094449278181075145555 -0.17209595739278255033 0.096107824510490311165 0.17235231419782756634 -0.07628774841955135444 -0.84895055380121964284 0.15042389708400910608;-0.043829903120132740479 -1.0150286357150886118 0.25265571014783921866 0.11276332629935831298 -0.35528282670093586093 0.32666949625943464408 0.11900544488731361337 0.41286993828866414002 0.17334849164782256681 -0.11140940165881672852 0.47353282224507431408 -1.6517895508642352898 0.0013042629855456976118 -0.54488423578174904893 -0.81359990635141010706 -0.098347946788355247727 -0.44560394777988282522 -0.94008292876146481998 -1.6102783876513131478 0.030086998126642401641;-0.056391211199227839201 0.42019934600844988104 -0.78818766096916581532 -1.1223900929260899328 0.56441943230420710265 -0.31921652899290964278 -0.01016058401091305026 -0.97725978827921800018 -0.0096318883893678226144 -0.0023400401508917615875 -0.66669741645201796576 0.043606461136658794531 1.5885895090530870455 0.11872281967158374028 -0.23766718536291886466 0.23661314477663492051 0.30698886567157240846 -0.10816527184752318391 -1.6235264688772255148 0.28948841960599192014;0.46396802994844943413 -0.1723950914245170607 -0.055475071007410559076 -0.24209234390347517119 -0.20528442462593718409 0.09935025339250597165 -0.0010909978714495316941 -0.82158182283541314472 -0.060500686703889708373 -0.028184328904972598406 -0.063625685115308680539 0.58105097536215788434 0.16583264916685219736 0.11559872552227382081 0.38514651972821700721 0.17079157685648055365 -0.29003080089630878247 -0.1911063829949391224 -0.95106991134468232829 -0.44039969048881061342;0.10885041001772378932 -0.37578934940874275661 0.22222737813658341444 0.23236882792743104864 -0.45710999945677749379 -0.0060718206222778016781 0.0014570349851319398457 0.16579539502845072607 0.072892641337541752566 -0.23239432329383871711 0.49392326979540440712 -0.0054656980788841593583 -0.52683888140223777974 -0.0042500851837443086312 -0.058648961198368015912 0.048441898678940185918 0.2147258096629810209 -0.052265819064916951842 -0.52797129596283620678 -0.36532497940039487805;0.53190618966139768808 0.12786504323950637074 -0.259671844880919378 -0.30814801911768552323 0.085084871288820349 -0.093312422781934287186 -0.030860091898388425369 -0.83763805813147784729 0.019203376686486993419 0.0043513444637765328477 -0.23295821530231974883 1.1421738068471434246 0.47177076188450267624 0.30826395406809670163 0.59692713855057644157 0.22351914046998680452 -0.068913298624154600835 -0.0058469469859187047506 -1.8360573385767946508 -0.37938416376717504219;0.070496776300442001717 1.0191352001804498961 -0.40617303356988782026 -1.1128009841643360378 0.70218162251740257052 -0.40173263475372411602 0.029134869078851793889 -0.96787314939656587942 -0.0029909820841076432615 -0.010383043209776803353 -1.1172001122483559143 -0.0081862259698619443266 1.7105345907360873792 -0.0039910991996948272029 -0.44211888354276041024 0.051695987782282869227 0.44340939474100643514 -0.040748608567032003347 -0.80259482219644529 0.292814860798542409;-0.1937742193459665585 0.45189736576882100216 -0.50880741103294724326 -1.4615158884839938302 0.9074224433730639916 -0.05714522452671853131 -0.0025225955424079309422 -1.0640663854817555833 -0.27232555587181228596 -0.0094685025891091661315 -0.64485680983835091951 -0.034646540812042173063 1.8328162808736825351 0.28490939148714500284 -0.31911611367561609764 0.23242517038866056245 0.098897728407393956096 -0.90981462570031179649 -1.8643027177942470551 0.28629109386147194583;-0.58349746335916863327 0.85816112950783340896 -0.16251297767323663601 0.87601100750033900066 -0.34424728326010733959 0.89271039807773244767 -5.012020559450689916 0.53703996975864365382 0.89159620588465116064 0.17599097155663992464 0.34995667926381041068 0.055380220059634749363 -3.2848025258916471181 0.42082553086271506926 -3.8541591253460993904 -0.63219052325434410555 -1.8555444129609646176 0.14124977317321060766 4.3352017690090729474 -0.52660411782297056327;-0.086242597859355007994 -0.13287977091977945521 -0.067696127087237809028 0.81509550297202570945 -0.28515151112205844308 0.9582808350283423815 -0.0043832894323160660408 0.8602584160562575244 -0.018055822774416276782 0.016628659131680070121 0.086653529655258146325 -0.036500510047599014907 -1.296224748644589253 -0.20743535756899220135 -0.032171346248432028392 -0.47419425582002933117 -1.2172925011715545196 -1.3648523973562485256 0.5199667169875400452 0.5932968705290653233;-0.21891247012141157313 -0.6529428443735965093 0.30395401608899064172 0.16467129485170023395 -0.27788447416565181802 0.32657435840407333938 0.08153645018767223529 0.5271579206891032765 0.03550478129166077107 -0.07180547164791943604 0.40024452713274338844 -1.4433146593718133577 -0.26155662276371838271 -0.48354067795437766231 -0.68977531822366633385 -0.15954214166824182142 -0.3257862919497634957 -0.57093297337965720484 0.021338613796035146852 0.16232233874989390743;-0.77597074436144963805 1.5371275166844990956 -0.56633909300848517265 -0.8975497453165248718 0.93366700191125540087 -0.48556335043336951163 0.010805094713287832775 -0.4177742099394866071 -0.73513382925069914453 0.0054058039163296153079 -1.3154019440822330989 0.02971726217249446092 0.1745079350025880438 0.19977642586645821821 -0.59485322145574637265 -0.10109747992683397466 0.66195941694808735356 1.7474776708200201458 0.202062736405278498 0.71584271160123869038;-0.91963987027193627721 0.17686303788241641843 0.61104355857813208441 -0.41207675578410463135 0.075440862106555206523 -0.51463156310543978211 0.0064725245741844607272 -0.3450714232223976996 0.60574085389690501824 0.011810662673056705405 -0.1286484797419534809 -0.054087701546613159431 -1.1368197206322976367 -0.01373387956531755931 0.10819791870886755203 0.26967450178441149111 0.56134536225640596641 -1.5305424780634320214 -0.51435507055741513938 -0.98238559672590519689;0.09594143649868688839 -0.27416999345297549118 -0.0053472406950033010697 -0.23744571098727276781 -0.22280579810950496 0.006494478690677040443 0.016327302956419140201 -0.2808714177323193284 -0.011803291947967548686 -0.36414969700331900615 0.31946579055985607765 -0.0017331364505121633034 1.1146010352278090672 0.11301634901122997734 -0.17524225764476777933 0.15437417051750521035 0.27380357042969394321 -0.026196549651218811045 -1.0868821679982836326 -0.34227372865125732515;-1.3075956611989134615 1.0558046563022844833 -0.74456441994919098093 -1.4279379512847847344 0.36678585995772849948 0.042531684510917808217 0.026768230997913769476 -1.4040123645329423141 -0.36742412534776380806 -1.0573503633909839827 -1.65039854037468392 -0.0047426235877084735315 2.0333468238699503594 1.1555069243003111001 -1.3363294052656751187 0.095256312968033940436 1.4353972648843356108 0.11910350402584740648 -3.2561529278996657055 0.031043877388942740098;-0.054551036372862890533 -0.047416580503059135854 0.28892012387393928297 0.1342598599353324873 -0.24374313405955139178 -0.8583047501647240729 0.0071592331815049908145 -0.071515112758587212616 0.16523785386440428824 -0.007122180932540588677 0.16143226184728359796 0.004212022832762391325 0.12018638546646662202 0.020131720026712408844 0.11320961283062683234 0.25788719545479288353 1.092546043808176659 1.3882384505710614331 0.7767154894653134356 -0.51622523000255438053;1.0429481439209189464 0.35537678737470762558 -1.0390899422212502845 -0.98928695665456256592 1.1286312378666136791 0.28090611011348576298 0.012089326507498446978 -1.1584806296957905758 -0.30092315065091285176 -0.002446840801682079701 -0.7727109008189846362 -0.0087498264617240865265 2.2745731595621867527 0.18669004810790174043 0.015956829631513496509 -0.02038835767901431284 -0.74726201890569765585 -1.7975625252744933391 -1.4992278039435249504 0.93461639179851663251;0.6861093294304689838 -1.6493557749458285233 0.68905210871605948597 1.4909169544540776808 -1.0007572771596715544 0.6330245824740670102 -0.014241272982202750688 1.2389985662540832223 0.14410007364464869073 0.0083130455495037201136 1.8454946699103391694 0.0038301711857343322641 -1.1293581622446680068 -0.055956935727365694766 0.6453367365169633274 0.0035711538545031640615 -0.65661618077153216522 -0.28175908098463453566 1.2995352046683161795 -0.79473186300374343283];

% Layer 4
b4 = [1.9542451674919270044;3.311176768354186617;-0.24701084541828072227];
LW4_3 = [1.2197658665462709493 -4.9658900098342693141 -3.4165335231297264684 -0.60463424739543536468 4.4122316065510647221 -0.43821889019486187644 5.7545230541497582877 0.71076983789584213813 0.75978526047495520412 -0.68544648450673473228 0.0021139396468251954106 1.0967206077982469825 1.0882857578541593746 0.34879605537901553491 -0.3895869676312790908 -3.7804407695931079303 -1.2828778941097795929 0.83192897260685427785 0.59812187104633596224 1.4564997673288608837;2.1120874753137823809 0.792554145189171666 -2.6357873036010408541 0.27218924112233766621 3.0609229264427795236 0.51788342393970665523 -0.51327610492859010449 -0.64405730837631836039 -2.7363433465129358702 1.062193836426946536 -3.5056503557070164412 3.1773253749781722455 -0.65757148147849420194 -0.75902654302679251064 0.012576713162325427187 0.33071661372229227416 0.059679488857700510596 3.4688116798585131306 -0.01486111026375278206 -5.5235533713599558325;0.77362464126224772532 1.599550142861118518 -2.1381771757865215555 -2.1120889445331663126 3.1049736649365353713 -2.0253339968913874891 -2.0472148911611247613 2.8920997424151853039 -2.0943633124134612977 -3.164994639998027548 -0.1048979562275419164 -2.2903691219638373511 3.9671624697078784472 2.5226225012377323509 -0.2188100571637542624 1.4061567672795869388 0.43740969134735241397 -2.9150445690814170696 -0.39175212954422128364 -1.5487671267074853976];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.488157065512143;0.548488133596352;0.526756879049773];
y1_step1.xoffset = [-2.28605;-1.810442;-1.770418];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
